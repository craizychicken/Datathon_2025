library(readr)
library(dplyr)
library(ggplot2)

df <- read_csv("cleaned_climate_data.csv")

# Filter out rows where rainfall is 0 before calculating the average.
# Then, group by week and stations and calculate the average
average_rainfall_by_week_and_id <- df %>%
  filter(rain > 0) %>%
  group_by(week, mount_id) %>%
  summarise(
    average_rain = mean(rain, na.rm = TRUE)
  )

# Create a bar chart to visualise the average for all station numbers
ggplot(average_rainfall_by_week_and_id, aes(x = as.factor(week), y = average_rain, fill = as.factor(mount_id))) +
  geom_bar(stat = "identity", alpha = 0.6) +
  labs(
    title = "Average Precipitation by Week for each Station",
    x = "Week",
    y = "Average Precipitation (mm)",
    fill = "Station Number"
  ) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))
